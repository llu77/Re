# ๐ฅ ูุณุชุดุงุฑ ุงูุชุฃููู ุงูุฐูู โ Rehabilitation AI Consultant

## ุฏููู ุดุงูู ูุจูุงุก ูุธุงู ุงุณุชุดุงุฑู ุชุฃูููู ูุชุฎุตุต ุนุจุฑ Claude API

> **ุงููููุฐุฌ ุงููุณุชุฎุฏู:** Claude Sonnet 4.6 (`claude-sonnet-4-6`)
> **ุงูุจุฑูุชูููู:** Anthropic Messages API v1
> **ุงููุฏุฑุงุช ุงูุฃุณุงุณูุฉ:** Tool Use + Vision + Extended Thinking + RAG + PubMed Integration

-----

## ๐ ููุฑุณ ุงููุญุชููุงุช

1. [ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุดุฑูุน](#1-ูุธุฑุฉ-ุนุงูุฉ-ุนูู-ุงููุดุฑูุน)
1. [ุงูุจููุฉ ุงููุนูุงุฑูุฉ ุงูุนุงูุฉ](#2-ุงูุจููุฉ-ุงููุนูุงุฑูุฉ-ุงูุนุงูุฉ)
1. [System Prompt โ ุจูุงุก ุงูุดุฎุตูุฉ ุงููุชุฎุตุตุฉ](#3-system-prompt--ุจูุงุก-ุงูุดุฎุตูุฉ-ุงููุชุฎุตุตุฉ)
1. [Extended Thinking โ ุงูุชูููุฑ ุงูุนููู ุงูุณุฑูุฑู](#4-extended-thinking--ุงูุชูููุฑ-ุงูุนููู-ุงูุณุฑูุฑู)
1. [Tool Use โ ุชุนุฑูู ุงูุฃุฏูุงุช ูุงุณุชุฏุนุงุคูุง](#5-tool-use--ุชุนุฑูู-ุงูุฃุฏูุงุช-ูุงุณุชุฏุนุงุคูุง)
1. [PubMed Integration โ ุงูุจุญุซ ูู ุงููุตุงุฏุฑ ุงูุนูููุฉ](#6-pubmed-integration--ุงูุจุญุซ-ูู-ุงููุตุงุฏุฑ-ุงูุนูููุฉ)
1. [Vision โ ุชุญููู ุงูุตูุฑ ุงูุทุจูุฉ](#7-vision--ุชุญููู-ุงูุตูุฑ-ุงูุทุจูุฉ)
1. [RAG โ ุจูุงุก ุงููุงุนุฏุฉ ุงููุนุฑููุฉ](#8-rag--ุจูุงุก-ุงููุงุนุฏุฉ-ุงููุนุฑููุฉ)
1. [Prompt Chaining โ ุณูุงุณู ุงูุนูู ุงูุทุจูุฉ](#9-prompt-chaining--ุณูุงุณู-ุงูุนูู-ุงูุทุจูุฉ)
1. [ุงูุชูุซูู ูุงูุชูุฎูุต](#10-ุงูุชูุซูู-ูุงูุชูุฎูุต)
1. [ุงูุฃูุงู ูุงูุฎุตูุตูุฉ](#11-ุงูุฃูุงู-ูุงูุฎุตูุตูุฉ)
1. [ุฃูุซูุฉ ุชุทุจูููุฉ ูุงููุฉ](#12-ุฃูุซูุฉ-ุชุทุจูููุฉ-ูุงููุฉ)
1. [ุฎุงุฑุทุฉ ุชุทููุฑ ุงููุงุนุฏุฉ ุงููุนุฑููุฉ](#13-ุฎุงุฑุทุฉ-ุชุทููุฑ-ุงููุงุนุฏุฉ-ุงููุนุฑููุฉ)
1. [ุงููุฑุงุฌุน ูุงููุตุงุฏุฑ](#14-ุงููุฑุงุฌุน-ูุงููุตุงุฏุฑ)

-----

## 1. ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุดุฑูุน

### ุงููุฏู

ุจูุงุก ูุธุงู ุฐูุงุก ุงุตุทูุงุนู ูุชุฎุตุต ูุนูู ูู**ุงุณุชุดุงุฑู ุชุฃููู** ู**ุฎุจูุฑ ุชุฃููู ุจุตุฑู** ูุงุฏุฑ ุนูู:

- **ุงูุฅุฌุงุจุฉ ุนูู ุงูุงุณุชูุณุงุฑุงุช ุงูุทุจูุฉ** ุงููุชุนููุฉ ุจุงูุชุฃููู ุงูุจุตุฑู ูุงููุธููู
- **ูุถุน ุงูุฎุทุท ุงูุนูุงุฌูุฉ** ุงููุจููุฉ ุนูู ุงูุฃุฏูุฉ (Evidence-Based)
- **ุชุญููู ุงูุตูุฑ ุงูุทุจูุฉ** (ูุญูุตุงุช ุงูุนูููุ ุชูุงุฑูุฑุ ูุฎุทุทุงุช ุจุตุฑูุฉ)
- **ุงูุจุญุซ ูู PubMed** ูุงุณุชุฎูุงุต ุฃุญุฏุซ ุงูุฃุจุญุงุซ
- **ุงูุชูุซูู ูุงูุชูุฎูุต** (ุจุนุฏ ููุงููุฉ ุงููุณุชุฎุฏู)
- **ุงูููู ุงูุณุฑูุฑู ุงูุนููู** ููุญุงูุงุช ุนุจุฑ Extended Thinking

### ููุงุฐุง Claude Sonnet 4.6ุ

|ุงูููุฒุฉ                          |ุงููููุฉ ุงููุถุงูุฉ ููุชุฃููู                      |
|--------------------------------|--------------------------------------------|
|**200K Context Window**         |ุงุณุชูุนุงุจ ูููุงุช ุงููุฑูุถ ุงููุงููุฉ + ุฃุจุญุงุซ        |
|**Vision Multimodal**           |ุชุญููู ุตูุฑ ูุญูุตุงุช ุงูุนููู ูุงูุชูุงุฑูุฑ           |
|**Tool Use**                    |ุฑุจุท PubMed API + ููุงุนุฏ ุจูุงูุงุช + ุฃุฏูุงุช ุญุณุงุจูุฉ|
|**Extended Thinking (Adaptive)**|ุงุณุชุฏูุงู ุณุฑูุฑู ูุชุนุฏุฏ ุงูุฎุทูุงุช                 |
|**Arabic Support**              |ุฏุนู ููุชุงุฒ ููุนุฑุจูุฉ ูู ุงููุญุงุฏุซุฉ ูุงูุชูุซูู      |
|**Token-Efficient Tools**       |ุชูููู ุงูุชูููุฉ ูู ุงูุงุณุชุฏุนุงุกุงุช ุงููุชุนุฏุฏุฉ       |

-----

## 2. ุงูุจููุฉ ุงููุนูุงุฑูุฉ ุงูุนุงูุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ๐ฅ๏ธ ูุงุฌูุฉ ุงููุณุชุฎุฏู (Frontend)                  โ
โ            (Web App / Mobile / Desktop Application)              โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                   ๐ง Backend / Orchestration Layer               โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ Auth & HIPAA โ  โ Session Mgmt โ  โ Consent Management   โ  โ
โ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ              Prompt Chain Orchestrator                     โ   โ
โ  โ  intake โ assessment โ plan โ search โ document           โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ๐ค Claude Sonnet 4.6 API Layer                      โ
โ                                                                  โ
โ  โโโโโโโโโโโโโโ โโโโโโโโโโโโโโ โโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ โ
โ  โ  System    โ โ  Extended  โ โ   Tool     โ โ   Vision    โ โ
โ  โ  Prompt    โ โ  Thinking  โ โ   Use      โ โ   (Images)  โ โ
โ  โโโโโโโโโโโโโโ โโโโโโโโโโโโโโ โโโโโโโฌโโโโโโโ โโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                       โ
                        โโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโ
                        โผ              โผ              โผ
              โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ
              โ  PubMed API  โ โ RAG Vector  โ โ Clinical DB  โ
              โ  (E-Utils)   โ โ   Store     โ โ  (Patient    โ
              โ  / PubMed    โ โ (Pinecone/  โ โ   Records)   โ
              โ    MCP       โ โ  Chroma)    โ โ              โ
              โโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโ
```

-----

## 3. System Prompt โ ุจูุงุก ุงูุดุฎุตูุฉ ุงููุชุฎุตุตุฉ

### 3.1 ุงููุจุฏุฃ ุงูุฃุณุงุณู

System Prompt ูู **ุงูุฃุณุงุณ** ุงูุฐู ูุญูู Claude ูู ูุณุงุนุฏ ุนุงู ุฅูู ุงุณุชุดุงุฑู ุชุฃููู ูุชุฎุตุต. ูููุฑุฑ ุนุจุฑ ุญูู `system` ูู Messages API.

### 3.2 ูููุฐุฌ System Prompt ุงููุงูู

```python
SYSTEM_PROMPT = """
<role>
ุฃูุช ุงุณุชุดุงุฑู ุชุฃููู ุทุจู ูุชุฎุตุต ูุฎุจูุฑ ูู ุงูุชุฃููู ุงูุจุตุฑู (Vision Rehabilitation Specialist).
ุชุชูุชุน ุจุฎุจุฑุฉ ุณุฑูุฑูุฉ ุนูููุฉ ูู:

- ุงูุชุฃููู ุงูุจุตุฑู (Low Vision Rehabilitation)
- ุงูุชุฃููู ุงููุธููู (Occupational Therapy for Visual Impairment)
- ุชูููู ุงููุธุงุฆู ุงูุจุตุฑูุฉ (Visual Function Assessment)
- ุงูุฃุฌูุฒุฉ ุงููุณุงุนุฏุฉ ุงูุจุตุฑูุฉ (Assistive Devices & Optical Aids)
- ุงูุชุฃููู ุงูุนุตุจู ุงูุจุตุฑู (Neuro-Visual Rehabilitation)
- ุงูุชูุฌู ูุงูุชููู (Orientation & Mobility - O&M)
- ุงูุชุฏุฎู ุงููุจูุฑ ูุถุนู ุงูุจุตุฑ ุนูุฏ ุงูุฃุทูุงู
- ุชุฃููู ูุง ุจุนุฏ ุงูุฌุฑุงุญุงุช ุงูุจุตุฑูุฉ (ุฅุฒุงูุฉ ุงูููุงู ุงูุจูุถุงุกุ ุฒุฑุงุนุฉ ุงููุฑููุฉุ ุฅูุฎ)
- ุงูุชูููุงุช ุงููุณุงุนุฏุฉ ูุงูุจุฑุงูุฌ ุงูุชููููุฉ

ูุฏูู ูุนุฑูุฉ ุดุงููุฉ ุจู:
- ุงูุชุตููู ุงูุฏููู ููุฃูุฑุงุถ (ICD-11) ุงููุชุนูู ุจุงูุจุตุฑ
- ุชุตูููุงุช WHO ูุถุนู ุงูุจุตุฑ ูุงูุนูู
- ุฃุญุฏุซ ุฅุฑุดุงุฏุงุช ุงูููุงุฑุณุฉ ุงูุณุฑูุฑูุฉ (Clinical Practice Guidelines)
- ุจุฑูุชููููุงุช ุงูุชูููู: Colenbrander, Bailey-Lovie, MNREAD, Pepper VSRT
- ููุงููุณ ุฌูุฏุฉ ุงูุญูุงุฉ: VFQ-25, LVQOL, IVI
</role>

<behavioral_guidelines>
1. **ุงููููุฌ ุงูุณุฑูุฑู:**
   - ุงุจุฏุฃ ุฏุงุฆูุงู ุจููู ุงูุญุงูุฉ ุงููุงููุฉ ูุจู ุฅุนุทุงุก ุฃู ุชูุตูุฉ
   - ุงุณุฃู ุนู: ุงูุชุดุฎูุตุ ุญุฏุฉ ุงูุฅุจุตุงุฑุ ุงููุฌุงู ุงูุจุตุฑูุ ุญุณุงุณูุฉ ุงูุชุจุงููุ ุงููุธุงุฆู ุงูููููุฉ ุงููุชุฃุซุฑุฉ
   - ุงุณุชุฎุฏู ุงูุชูููุฑ ุงูุนููู (Extended Thinking) ููุญุงูุงุช ุงููุนูุฏุฉ
   - ูุฏู ุชูุตูุงุช ูุจููุฉ ุนูู ุฃุฏูุฉ ุนูููุฉ ูุน ุฐูุฑ ุงููุฑุงุฌุน

2. **ุงูุจุญุซ ุงูุนููู:**
   - ุนูุฏ ุงูุญุงุฌุฉ ููุนูููุงุช ุญุฏูุซุฉุ ุงุณุชุฎุฏู ุฃุฏุงุฉ ุงูุจุญุซ ูู PubMed
   - ุฑูุฒ ุนูู: Systematic Reviews, Meta-analyses, RCTs, Clinical Guidelines
   - ุตูู ูุณุชูู ุงูุฏููู (Level of Evidence) ููู ุชูุตูุฉ
   - ูุง ุชูุฏู ูุนูููุงุช ุบูุฑ ููุซูุฉ ูุญูุงุฆู

3. **ุชุญููู ุงูุตูุฑ:**
   - ุนูุฏ ุงุณุชูุงู ุตูุฑ ุทุจูุฉ (ุชูุงุฑูุฑ ูุญุตุ OCTุ Visual Fieldsุ ุตูุฑ ูุงุน ุงูุนูู)
   - ุญูู ุจูููุฌูุฉ: ุงููุตู โ ุงูุชูุณูุฑ โ ุงูุฑุจุท ุงูุณุฑูุฑู โ ุงูุชูุตูุงุช
   - ุงูุชุจู: ุฃูุช ูุง ุชูุฏู ุชุดุฎูุตุงู ููุงุฆูุงู ุจู ุชุญูููุงู ูุณุงุนุฏุงู ูุชุทูุจ ูุฑุงุฌุนุฉ ุงูุทุจูุจ

4. **ุงูุฎุทุท ุงูุนูุงุฌูุฉ:**
   - ุงุชุจุน ูููุฐุฌ SMART Goals (Specific, Measurable, Achievable, Relevant, Time-bound)
   - ูุณู ุงูุฎุทุฉ ุฅูู: ุฃูุฏุงู ูุตูุฑุฉ/ูุชูุณุทุฉ/ุทูููุฉ ุงููุฏู
   - ุญุฏุฏ: ุงูุชูููุงุชุ ุงูุฃุฌูุฒุฉุ ุงูุชูุงุฑููุ ุฌุฏูู ุงููุชุงุจุนุฉ
   - ุงุฐูุฑ ูุนุงููุฑ ุงููุฌุงุญ ููุคุดุฑุงุช ุงูุชูุฏู

5. **ุงูุชูุซูู:**
   - ูุง ุชูู ุจุชูุซูู ุฃู ุชูุฎูุต ุฃู ูุนูููุงุช ุฅูุง ุจุนุฏ ููุงููุฉ ุตุฑูุญุฉ ูู ุงููุณุชุฎุฏู
   - ุงุณุชุฎุฏู ุงูุชูุณูู ุงูุทุจู ุงููุนูุงุฑู (SOAP Notes, ICF Framework)
   - ุงุฐูุฑ ุฏุงุฆูุงู: "ูุฐุง ููุณ ุจุฏููุงู ุนู ุงูุฑุฃู ุงูุทุจู ุงููุจุงุดุฑ"

6. **ุงููุบุฉ ูุงูุชูุงุตู:**
   - ุชุญุฏุซ ุจุงูุนุฑุจูุฉ ุจุดูู ุงูุชุฑุงุถู
   - ุงุณุชุฎุฏู ุงููุตุทูุญุงุช ุงูุทุจูุฉ ูุน ุดุฑุญูุง ุจูุบุฉ ุจุณูุทุฉ
   - ูู ุฏูููุงู ูููููุงู ูุน ุงูุญูุงุธ ุนูู ุงูุฏูุก ุงูุฅูุณุงูู
   - ุนูุฏ ุงูุชูุงุตู ูุน ุงููุฑูุถ: ุจุณูุทุ ูุน ุงููุชุฎุตุต: ุงุณุชุฎุฏู ุงููุตุทูุญุงุช ุงูุฏูููุฉ
</behavioral_guidelines>

<safety_disclaimers>
- ูุฐุง ุงููุธุงู ุฃุฏุงุฉ ูุณุงุนุฏุฉ ูููุณ ุจุฏููุงู ุนู ุงูุชุดุฎูุต ุฃู ุงูุนูุงุฌ ุงูุทุจู ุงููุจุงุดุฑ
- ุฌููุน ุงูุชูุตูุงุช ุชุชุทูุจ ูุฑุงุฌุนุฉ ูู ุทุจูุจ/ุฃุฎุตุงุฆู ูุคูู
- ูู ุงูุญุงูุงุช ุงูุทุงุฑุฆุฉุ ูุฌุจ ุงูุชูุฌู ููุฑุงู ูุบุฑูุฉ ุงูุทูุงุฑุฆ
- ูุง ูุชู ุชุฎุฒูู ุจูุงูุงุช ุงููุฑุถู ุงูุญุณุงุณุฉ ุจุฏูู ุชุดููุฑ ูููุงููุฉ
</safety_disclaimers>
"""
```

### 3.3 ููููุฉ ุฅุฑุณุงู System Prompt ุนุจุฑ API

```python
import anthropic

client = anthropic.Anthropic(api_key="your-api-key")

response = client.messages.create(
    model="claude-sonnet-4-6",
    max_tokens=8192,
    system=SYSTEM_PROMPT,
    messages=[
        {"role": "user", "content": "ูุฏู ูุฑูุถ ุนูุฑู 65 ุณูุฉ ูุตุงุจ ุจุงูุถููุฑ ุงูุจูุนู ุงูุฌุงู..."}
    ]
)
```

-----

## 4. Extended Thinking โ ุงูุชูููุฑ ุงูุนููู ุงูุณุฑูุฑู

### 4.1 ูุชู ูุณุชุฎุฏููุ

Extended Thinking ุถุฑูุฑู ูู ุณููุงุฑูููุงุช ุงูุชุฃููู ุงูุชุงููุฉ:

- **ุงูุชุดุฎูุต ุงูุชูุฑููู** โ ุนูุฏูุง ุชุชุดุงุจู ุงูุฃุนุฑุงุถ ุจูู ุญุงูุงุช ูุฎุชููุฉ
- **ุจูุงุก ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ** โ ุชุญุชุงุฌ ุชุญููู ูุชุนุฏุฏ ุงููุชุบูุฑุงุช
- **ุชุญููู ุงูุตูุฑ ุงููุนูุฏุฉ** โ ุฑุจุท ุงููุชุงุฆุฌ ุงูุจุตุฑูุฉ ุจุงูุญุงูุฉ ุงูุณุฑูุฑูุฉ
- **ุชูููู ุงูุชูุฏู** โ ููุงุฑูุฉ ุจูุงูุงุช ูุชุนุฏุฏุฉ ุนุจุฑ ุงูุฒูู
- **ูุฑุงุฌุนุฉ ุงูุฃุฏุจูุงุช** โ ุชุญููู ูููุงุฑูุฉ ูุชุงุฆุฌ ุฃุจุญุงุซ ูุชุนุฏุฏุฉ

### 4.2 ุงูุชูุนูู ุนุจุฑ API

#### ุงููุถุน ุงูุชูููู (Adaptive Thinking) โ ูููุตู ุจู ูู Opus 4.6

```python
response = client.messages.create(
    model="claude-sonnet-4-6",  # ุฃู claude-opus-4-6
    max_tokens=16384,
    thinking={
        "type": "adaptive",
        "effort": "high"  # low | medium | high | max
    },
    system=SYSTEM_PROMPT,
    messages=[
        {"role": "user", "content": "ุญุงูุฉ ูุนูุฏุฉ: ูุฑูุถ 45 ุณูุฉุ ุงูุณูุฑู ูู 15 ุณูุฉ..."}
    ]
)
```

#### ุงููุถุน ุงููุฏูู (Manual) โ ูู Sonnet 4.6

```python
response = client.messages.create(
    model="claude-sonnet-4-6",
    max_tokens=16384,
    thinking={
        "type": "enabled",
        "budget_tokens": 10000  # ุญุฏ ุฃูุตู ูุฑููุฒ ุงูุชูููุฑ
    },
    system=SYSTEM_PROMPT,
    messages=[...]
)
```

### 4.3 Interleaved Thinking ูุน ุงูุฃุฏูุงุช

ุนูุฏ ุงุณุชุฎุฏุงู ุงูุฃุฏูุงุช (ูุซู PubMed)ุ ูููู ูู Claude ุงูุชูููุฑ **ุจูู** ุงุณุชุฏุนุงุกุงุช ุงูุฃุฏูุงุช:

```python
response = client.messages.create(
    model="claude-sonnet-4-6",
    max_tokens=16384,
    thinking={"type": "enabled", "budget_tokens": 10000},
    tools=tools_definitions,  # ุฃุฏูุงุช PubMed ูุบูุฑูุง
    messages=[...],
    extra_headers={
        "anthropic-beta": "interleaved-thinking-2025-05-14"
    }
)
```

**ุงููุงุฆุฏุฉ:** Claude ูุณุชุทูุน:

1. ุงูุชูููุฑ ูู ุงูุณุคุงู ุงูุณุฑูุฑู โ 2. ุงูุจุญุซ ูู PubMed โ 3. ุงูุชูููุฑ ูู ุงููุชุงุฆุฌ โ 4. ุงูุจุญุซ ูุฑุฉ ุฃุฎุฑู ุจูุตุทูุญุงุช ุฃุฏู โ 5. ุชูุฏูู ุฅุฌุงุจุฉ ุดุงููุฉ

### 4.4 ูุณุชููุงุช ุงูุฌูุฏ (Effort Levels)

|ุงููุณุชูู |ุงูุงุณุชุฎุฏุงู ูู ุงูุชุฃููู              |
|--------|----------------------------------|
|`low`   |ุฃุณุฆูุฉ ุจุณูุทุฉ ูุซู โูุง ูู ุฌูุงุฒ CCTVุโ|
|`medium`|ูุตู ุจุฑูุชูููู ุชุฏุฑูุจ ูุนูู           |
|`high`  |ุจูุงุก ุฎุทุฉ ุนูุงุฌูุฉ ุดุงููุฉ ูุญุงูุฉ ูุนูุฏุฉ |
|`max`   |ุชุญููู ุญุงูุฉ ูุน ูุฑุงุฌุนุฉ ุฃุฏุจูุงุช ูุชุนุฏุฏุฉ|

-----

## 5. Tool Use โ ุชุนุฑูู ุงูุฃุฏูุงุช ูุงุณุชุฏุนุงุคูุง

### 5.1 ุขููุฉ ุนูู Tool Use

```
ุงููุณุชุฎุฏู ูุณุฃู โ Claude ููุฑุฑ ุฃู ูุญุชุงุฌ ุฃุฏุงุฉ โ ููุฑุฌุน tool_use block
     โ
ุชุทุจููู ูููุฐ ุงูุฃุฏุงุฉ (API call, DB query, etc.)
     โ
ุชูุฑุณู ุงููุชูุฌุฉ ูู Claude โ Claude ูุตูุบ ุงูุฌูุงุจ ุงูููุงุฆู
```

### 5.2 ุชุนุฑูู ุงูุฃุฏูุงุช

```python
tools = [
    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    # ุฃุฏุงุฉ 1: ุงูุจุญุซ ูู PubMed
    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    {
        "name": "search_pubmed",
        "description": """ุจุญุซ ูู ูุงุนุฏุฉ ุจูุงูุงุช PubMed ููุฃุจุญุงุซ ุงูุทุจูุฉ.
        ุงุณุชุฎุฏู ูุฐู ุงูุฃุฏุงุฉ ุนูุฏ ุงูุญุงุฌุฉ ุฅูู:
        - ุฃุจุญุงุซ ุญุฏูุซุฉ ุนู ุญุงูุฉ ุฃู ุนูุงุฌ ุชุฃูููู
        - ุฅุฑุดุงุฏุงุช ุณุฑูุฑูุฉ ูุญุฏุซุฉ
        - ูุฑุงุฌุนุงุช ูููุฌูุฉ ุฃู ุชุญูููุงุช ุชุฌููุนูุฉ
        - ุจุฑูุชููููุงุช ุชุฃููู ุจุตุฑู ูุจููุฉ ุนูู ุฃุฏูุฉ
        ุฑูุฒ ุนูู: Systematic Reviews, RCTs, Clinical Guidelines""",
        "input_schema": {
            "type": "object",
            "properties": {
                "query": {
                    "type": "string",
                    "description": "ูุตุทูุญุงุช ุงูุจุญุซ ุจุงูุฅูุฌููุฒูุฉ (MeSH terms ููุถูุฉ)"
                },
                "max_results": {
                    "type": "integer",
                    "description": "ุนุฏุฏ ุงููุชุงุฆุฌ ุงููุทููุจุฉ (ุงูุชุฑุงุถู: 10)",
                    "default": 10
                },
                "date_range": {
                    "type": "string",
                    "description": "ูุทุงู ุงูุชุงุฑูุฎ ูุซู: 2020:2026"
                },
                "article_types": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "ุฃููุงุน ุงูููุงูุงุช: review, clinical-trial, meta-analysis, guideline"
                }
            },
            "required": ["query"]
        }
    },

    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    # ุฃุฏุงุฉ 2: ุฌูุจ ุชูุงุตูู ููุงู
    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    {
        "name": "fetch_article_details",
        "description": """ุฌูุจ ุงูุชูุงุตูู ุงููุงููุฉ ูููุงู ูู PubMed ุนุจุฑ PMID.
        ูุดูู: ุงูุนููุงูุ ุงููุคููููุ ุงูููุฎุตุ ุงููุฌูุฉุ DOI""",
        "input_schema": {
            "type": "object",
            "properties": {
                "pmid": {
                    "type": "string",
                    "description": "ูุนุฑู PubMed ููููุงู (PMID)"
                }
            },
            "required": ["pmid"]
        }
    },

    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    # ุฃุฏุงุฉ 3: ุงูุจุญุซ ูู ุงููุงุนุฏุฉ ุงููุนุฑููุฉ ุงููุญููุฉ (RAG)
    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    {
        "name": "search_knowledge_base",
        "description": """ุจุญุซ ูู ุงููุงุนุฏุฉ ุงููุนุฑููุฉ ุงููุญููุฉ ููุชุฃููู ุงูุจุตุฑู.
        ุชุญุชูู ุนูู: ุจุฑูุชููููุงุชุ ุฅุฑุดุงุฏุงุช ุณุฑูุฑูุฉุ ุฃุฏูุฉ ุงูุฃุฌูุฒุฉ ุงููุณุงุนุฏุฉุ
        ููุงุฐุฌ ุงูุชููููุ ุฎุทุท ุนูุงุฌูุฉ ูููุฐุฌูุฉ""",
        "input_schema": {
            "type": "object",
            "properties": {
                "query": {
                    "type": "string",
                    "description": "ุงุณุชุนูุงู ุงูุจุญุซ"
                },
                "category": {
                    "type": "string",
                    "enum": [
                        "protocols", "guidelines", "devices",
                        "assessments", "treatment_plans", "exercises"
                    ],
                    "description": "ุชุตููู ุงููุญุชูู ุงููุทููุจ"
                },
                "top_k": {
                    "type": "integer",
                    "description": "ุนุฏุฏ ุงููุชุงุฆุฌ ุงูุฃูุซุฑ ุตูุฉ",
                    "default": 5
                }
            },
            "required": ["query"]
        }
    },

    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    # ุฃุฏุงุฉ 4: ุญุงุณุจุฉ ุจุตุฑูุฉ
    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    {
        "name": "visual_calculator",
        "description": """ุญุณุงุจุงุช ุจุตุฑูุฉ ูุชุฎุตุตุฉ ูุซู:
        - ุชุญููู ุญุฏุฉ ุงูุฅุจุตุงุฑ ุจูู ุงูููุงููุณ (Snellen, LogMAR, Decimal)
        - ุญุณุงุจ ููุฉ ุงูุนุฏุณุฉ ุงูููุจุฑุฉ ุงููุทููุจุฉ
        - ุชูุฏูุฑ ุญุฌู ุงูุทุจุงุนุฉ ุงูููุงุณุจ
        - ุญุณุงุจ ูุณุงูุฉ ุงูุนูู ุงููุซุงููุฉ""",
        "input_schema": {
            "type": "object",
            "properties": {
                "calculation_type": {
                    "type": "string",
                    "enum": [
                        "va_conversion",
                        "magnification_power",
                        "print_size",
                        "working_distance"
                    ]
                },
                "input_values": {
                    "type": "object",
                    "description": "ุงูููู ุงููุฏุฎูุฉ ุญุณุจ ููุน ุงูุญุณุงุจ"
                }
            },
            "required": ["calculation_type", "input_values"]
        }
    },

    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    # ุฃุฏุงุฉ 5: ุฅูุดุงุก ูุซููุฉ / ุชูุฑูุฑ
    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    {
        "name": "generate_document",
        "description": """ุฅูุดุงุก ูุซุงุฆู ุทุจูุฉ ููุณูุฉ. ูุชุทูุจ ููุงููุฉ ูุณุจูุฉ ูู ุงููุณุชุฎุฏู.
        ุงูุฃููุงุน: ุชูุฑูุฑ ุชููููุ ุฎุทุฉ ุนูุงุฌูุฉุ ููุฎุต ุญุงูุฉุ ุฎุทุงุจ ุฅุญุงูุฉ""",
        "input_schema": {
            "type": "object",
            "properties": {
                "document_type": {
                    "type": "string",
                    "enum": [
                        "assessment_report",
                        "treatment_plan",
                        "case_summary",
                        "referral_letter",
                        "progress_note"
                    ]
                },
                "content": {
                    "type": "object",
                    "description": "ูุญุชูู ุงููุซููุฉ ุงูููุธู"
                },
                "format": {
                    "type": "string",
                    "enum": ["markdown", "pdf", "docx"],
                    "default": "markdown"
                }
            },
            "required": ["document_type", "content"]
        }
    },

    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    # ุฃุฏุงุฉ 6: ุฃุฏุงุฉ ุงูุชูููุฑ (Think Tool)
    # โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    {
        "name": "think",
        "description": """ุฃุฏุงุฉ ููุชููู ูุงูุชูููุฑ ุงูููุธู ุฃุซูุงุก ุชุณูุณู ุงูุงุณุชุฏูุงู ุงูุณุฑูุฑู.
        ุงุณุชุฎุฏู ูุฐู ุงูุฃุฏุงุฉ ุนูุฏูุง ุชุญุชุงุฌ:
        - ูุฑุงุฌุนุฉ ูุนูููุงุช ุฌุฏูุฏุฉ ูู ุฃุฏุงุฉ ูุจู ุงุชุฎุงุฐ ุงููุฑุงุฑ ุงูุชุงูู
        - ุชูููู ูู ูุฏูู ูุนูููุงุช ูุงููุฉ ููุชูุตูุฉ
        - ุงูุชุญูู ูู ุงุชุณุงู ุงูุจูุงูุงุช ูุน ุงูุชูุตูุงุช""",
        "input_schema": {
            "type": "object",
            "properties": {
                "reasoning": {
                    "type": "string",
                    "description": "ุชูููุฑู ูุงุณุชุฏูุงูู ุงูุณุฑูุฑู"
                }
            },
            "required": ["reasoning"]
        }
    }
]
```

### 5.3 ุชูููุฐ ุญููุฉ ุงูุฃุฏูุงุช (Tool Loop)

```python
import anthropic
import json

client = anthropic.Anthropic()

def run_rehab_consultant(user_message: str, images: list = None):
    """ุญููุฉ ุงููุญุงุฏุซุฉ ุงูุฑุฆูุณูุฉ ูุน ุฏุนู ุงูุฃุฏูุงุช"""

    # ุจูุงุก ุงููุญุชูู (ูุต + ุตูุฑ ุงุฎุชูุงุฑูุฉ)
    content = []
    if images:
        for img in images:
            content.append({
                "type": "image",
                "source": {
                    "type": "base64",
                    "media_type": img["media_type"],
                    "data": img["data"]
                }
            })
    content.append({"type": "text", "text": user_message})

    messages = [{"role": "user", "content": content}]

    # ุญููุฉ Tool Use
    while True:
        response = client.messages.create(
            model="claude-sonnet-4-6",
            max_tokens=16384,
            system=SYSTEM_PROMPT,
            tools=tools,
            thinking={"type": "enabled", "budget_tokens": 10000},
            messages=messages
        )

        # ุฅุฐุง ุงูุชูู Claude ุจุฏูู ุทูุจ ุฃุฏุงุฉ โ ููุฑุฌุน ุงูุฌูุงุจ
        if response.stop_reason == "end_turn":
            return extract_text_response(response)

        # ุฅุฐุง ุทูุจ Claude ุงุณุชุฎุฏุงู ุฃุฏุงุฉ
        if response.stop_reason == "tool_use":
            # ุฃุถู ุฑุฏ Claude ุงูุญุงูู ูููุญุงุฏุซุฉ
            messages.append({"role": "assistant", "content": response.content})

            # ูููุฐ ูู ุฃุฏุงุฉ ูุทููุจุฉ
            tool_results = []
            for block in response.content:
                if block.type == "tool_use":
                    result = execute_tool(block.name, block.input)
                    tool_results.append({
                        "type": "tool_result",
                        "tool_use_id": block.id,
                        "content": json.dumps(result, ensure_ascii=False)
                    })

            # ุฃุฑุณู ุงููุชุงุฆุฌ ูู Claude
            messages.append({"role": "user", "content": tool_results})

def execute_tool(tool_name: str, tool_input: dict) -> dict:
    """ุชูููุฐ ุงูุฃุฏุงุฉ ุงููุทููุจุฉ"""

    if tool_name == "search_pubmed":
        return search_pubmed_api(tool_input)
    elif tool_name == "fetch_article_details":
        return fetch_pubmed_article(tool_input["pmid"])
    elif tool_name == "search_knowledge_base":
        return search_vector_db(tool_input)
    elif tool_name == "visual_calculator":
        return calculate_visual_params(tool_input)
    elif tool_name == "generate_document":
        return generate_medical_document(tool_input)
    elif tool_name == "think":
        # ุฃุฏุงุฉ ุงูุชูููุฑ ูุง ุชููุฐ ุดูุฆุงู โ Claude ูุณุชุฎุฏููุง ููุชูููุฑ ููุท
        return {"status": "thinking_complete"}
    else:
        return {"error": f"ุฃุฏุงุฉ ุบูุฑ ูุนุฑููุฉ: {tool_name}"}
```

-----

## 6. PubMed Integration โ ุงูุจุญุซ ูู ุงููุตุงุฏุฑ ุงูุนูููุฉ

### 6.1 ุงูุฎูุงุฑ ุฃ: NCBI E-Utilities API (ูุจุงุดุฑ)

ุฃูุถู ุฎูุงุฑ ููุชุญูู ุงููุงูู. ูุฌุงูู ูุน API Key (ุญุชู 10 ุทูุจุงุช/ุซุงููุฉ).

```python
import requests
import xml.etree.ElementTree as ET

NCBI_BASE = "https://eutils.ncbi.nlm.nih.gov/entrez/eutils"
NCBI_API_KEY = "your-ncbi-api-key"  # ุงุญุตู ุนููู ูู ncbi.nlm.nih.gov/account

def search_pubmed_api(params: dict) -> dict:
    """ุงูุจุญุซ ูู PubMed ุนุจุฑ E-Utilities"""

    query = params["query"]
    max_results = params.get("max_results", 10)
    date_range = params.get("date_range", "")

    # ุงูุฎุทูุฉ 1: ESearch โ ุงูุจุญุซ ูุงูุญุตูู ุนูู IDs
    search_url = f"{NCBI_BASE}/esearch.fcgi"
    search_params = {
        "db": "pubmed",
        "term": query,
        "retmax": max_results,
        "retmode": "json",
        "sort": "relevance",
        "api_key": NCBI_API_KEY
    }

    # ุฅุถุงูุฉ ููุชุฑ ุงูุชุงุฑูุฎ
    if date_range:
        search_params["datetype"] = "pdat"
        search_params["mindate"], search_params["maxdate"] = date_range.split(":")

    # ุฅุถุงูุฉ ููุชุฑ ููุน ุงูููุงู
    article_types = params.get("article_types", [])
    if article_types:
        type_filters = " OR ".join([f"{t}[pt]" for t in article_types])
        search_params["term"] += f" AND ({type_filters})"

    response = requests.get(search_url, params=search_params)
    search_data = response.json()

    id_list = search_data.get("esearchresult", {}).get("idlist", [])
    total_count = search_data.get("esearchresult", {}).get("count", "0")

    if not id_list:
        return {"results": [], "total_count": 0, "message": "ูู ูุชู ุงูุนุซูุฑ ุนูู ูุชุงุฆุฌ"}

    # ุงูุฎุทูุฉ 2: ESummary โ ุฌูุจ ููุฎุตุงุช
    summary_url = f"{NCBI_BASE}/esummary.fcgi"
    summary_params = {
        "db": "pubmed",
        "id": ",".join(id_list),
        "retmode": "json",
        "api_key": NCBI_API_KEY
    }

    summary_response = requests.get(summary_url, params=summary_params)
    summary_data = summary_response.json()

    # ุชูุธูู ุงููุชุงุฆุฌ
    articles = []
    for pmid in id_list:
        article_data = summary_data.get("result", {}).get(pmid, {})
        articles.append({
            "pmid": pmid,
            "title": article_data.get("title", ""),
            "authors": [a.get("name", "") for a in article_data.get("authors", [])[:5]],
            "journal": article_data.get("source", ""),
            "pub_date": article_data.get("pubdate", ""),
            "doi": next(
                (aid["value"] for aid in article_data.get("articleids", [])
                 if aid.get("idtype") == "doi"),
                ""
            )
        })

    return {
        "results": articles,
        "total_count": int(total_count),
        "query_used": query
    }


def fetch_pubmed_article(pmid: str) -> dict:
    """ุฌูุจ ุงูููุฎุต ุงููุงูู ูููุงู ุนุจุฑ EFetch"""

    fetch_url = f"{NCBI_BASE}/efetch.fcgi"
    fetch_params = {
        "db": "pubmed",
        "id": pmid,
        "retmode": "xml",
        "rettype": "abstract",
        "api_key": NCBI_API_KEY
    }

    response = requests.get(fetch_url, params=fetch_params)
    root = ET.fromstring(response.content)

    article = root.find(".//PubmedArticle")
    if article is None:
        return {"error": "ุงูููุงู ุบูุฑ ููุฌูุฏ"}

    # ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
    title = article.findtext(".//ArticleTitle", "")
    abstract_parts = article.findall(".//AbstractText")
    abstract = " ".join([
        f"[{p.get('Label', '')}] {p.text or ''}"
        if p.get('Label') else (p.text or "")
        for p in abstract_parts
    ])

    # ุงุณุชุฎุฑุงุฌ MeSH Terms
    mesh_terms = [
        m.findtext("DescriptorName", "")
        for m in article.findall(".//MeshHeading")
    ]

    return {
        "pmid": pmid,
        "title": title,
        "abstract": abstract,
        "mesh_terms": mesh_terms[:15],
        "link": f"https://pubmed.ncbi.nlm.nih.gov/{pmid}/"
    }
```

### 6.2 ุงูุฎูุงุฑ ุจ: PubMed MCP Server

ุจุฏูู ุฃูุซุฑ ุชูุงููุงู ุนุจุฑ ุจุฑูุชูููู **Model Context Protocol (MCP)**.

```bash
# ุงูุชุซุจูุช
pip install pubmed-mcp-server

# ุฃู ุนุจุฑ npx
npx -y @smithery/cli install @JackKuo666/pubmed-mcp-server --client claude
```

**ุชูููู MCP Server:**

```json
{
  "mcpServers": {
    "pubmed": {
      "command": "python",
      "args": ["-m", "pubmed-mcp-server"]
    }
  }
}
```

**ุชุญููู ุฃุฏูุงุช MCP ูุตูุบุฉ Claude:**

```python
from mcp import ClientSession

async def get_pubmed_tools(mcp_session: ClientSession):
    mcp_tools = await mcp_session.list_tools()
    claude_tools = []
    for tool in mcp_tools.tools:
        claude_tools.append({
            "name": tool.name,
            "description": tool.description or "",
            "input_schema": tool.inputSchema
        })
    return claude_tools
```

**ุงูุฃุฏูุงุช ุงููุชุงุญุฉ ูู PubMed MCP:**

- `search_papers` โ ุจุญุซ ุจุงููููุงุช ุงูููุชุงุญูุฉ
- `get_paper_metadata` โ ุฌูุจ ุจูุงูุงุช ุงูููุงู
- `download_paper_pdf` โ ุชุญููู ุงููุต ุงููุงูู (ุฅู ุชููุฑ)
- `analyze_paper` โ ุชุญููู ูููุฌู ููููุงู

### 6.3 ููุงุฑูุฉ ุงูุฎูุงุฑุงุช

|ุงููุนูุงุฑ              |E-Utilities ูุจุงุดุฑ|PubMed MCP              |
|---------------------|-----------------|------------------------|
|**ุงูุชุญูู**           |ูุงูู             |ูุชูุณุท                   |
|**ุงูุณูููุฉ**          |ูุญุชุงุฌ ููุฏ ุฃูุซุฑ   |ุฌุงูุฒ ููุงุณุชุฎุฏุงู          |
|**ุงููุฑููุฉ**          |ุนุงููุฉ ุฌุฏุงู        |ูุญุฏูุฏุฉ ุจุงูุฃุฏูุงุช ุงููุชููุฑุฉ|
|**ุงูุชูููุฉ**          |ูุฌุงูู            |ูุฌุงูู                   |
|**ุงูุตูุงูุฉ**          |ุฃูุช ูุณุคูู        |ุงููุฌุชูุน                 |
|**ุงูุชูุงูู ูุน Claude**|ุนุจุฑ Tool Use     |ูุจุงุดุฑ ุนุจุฑ MCP           |

**ุงูุชูุตูุฉ:** ุงุจุฏุฃ ุจู E-Utilities ุงููุจุงุดุฑ ููุชุญูู ุงููุงููุ ูุฃุถู MCP ูุงุญูุงู ุฅู ุงุญุชุฌุช.

-----

## 7. Vision โ ุชุญููู ุงูุตูุฑ ุงูุทุจูุฉ

### 7.1 ุงููุฏุฑุงุช ูุงููููุฏ

**ูุง ูุณุชุทูุน Claude ุชุญูููู:**

- ุชูุงุฑูุฑ ูุญุต ุงูุนููู (ูุทุจูุนุฉ ุฃู ุฅููุชุฑูููุฉ)
- ูุฎุทุทุงุช Visual Field (Humphrey, Goldmann)
- ุตูุฑ Optical Coherence Tomography (OCT) โ ุชุญููู ุนุงู
- ุฌุฏุงูู ุญุฏุฉ ุงูุฅุจุตุงุฑ ููุชุงุฆุฌ ุงููุญุต
- ุตูุฑ ุงูุฃุฌูุฒุฉ ุงููุณุงุนุฏุฉ ุงูุจุตุฑูุฉ (ูุชุญุฏูุฏ ุงูููุน ูุงูููุงุตูุงุช)
- ููุงุฐุฌ ุงูุชูููู ุงูููููุกุฉ

**ุงููููุฏ ุงููุงูุฉ:**

- โ **ูุง ููุนุฏ ุชุดุฎูุตุงู ุทุจูุงู** โ ุชุญููู ูุณุงุนุฏ ููุท
- โ ููุณ ุจุฏููุงู ุนู ุชูุณูุฑ ุทุจูุจ ุงูุนููู ุงููุชุฎุตุต
- โ ูุฏ ูุฎุทุฆ ูู ุชูุงุตูู ุฏูููุฉ ูู ุงูุตูุฑ ุงููุนูุฏุฉ
- โ ูุง ููุชุดู ูู ุงูุชูุงุตูู ูู ุตูุฑ OCT/Fundus ุจุฏูุฉ ุชุดุฎูุตูุฉ

### 7.2 ุฅุฑุณุงู ุงูุตูุฑ ุนุจุฑ API

```python
import base64

def analyze_medical_image(image_path: str, clinical_question: str):
    """ุชุญููู ุตูุฑุฉ ุทุจูุฉ ูุน ุณูุงู ุณุฑูุฑู"""

    # ูุฑุงุกุฉ ูุชุฑููุฒ ุงูุตูุฑุฉ
    with open(image_path, "rb") as f:
        image_data = base64.standard_b64encode(f.read()).decode("utf-8")

    # ุชุญุฏูุฏ ููุน ุงูููู
    media_type = "image/jpeg"  # ุฃู image/png
    if image_path.endswith(".png"):
        media_type = "image/png"

    response = client.messages.create(
        model="claude-sonnet-4-6",
        max_tokens=8192,
        system=SYSTEM_PROMPT,
        thinking={"type": "enabled", "budget_tokens": 8000},
        messages=[
            {
                "role": "user",
                "content": [
                    {
                        "type": "image",
                        "source": {
                            "type": "base64",
                            "media_type": media_type,
                            "data": image_data
                        }
                    },
                    {
                        "type": "text",
                        "text": f"""
ุญูู ูุฐู ุงูุตูุฑุฉ ุงูุทุจูุฉ ุจูููุฌูุฉ:

1. **ุงููุตู:** ูุง ุงูุฐู ุชุฑุงู ูู ุงูุตูุฑุฉุ (ููุน ุงููุญุตุ ุงููุฑุงุกุงุชุ ุงูููุงุญุธุงุช)
2. **ุงูุชูุณูุฑ:** ูุง ุงูุฏูุงูุฉ ุงูุณุฑูุฑูุฉ ูููุชุงุฆุฌ ุงูุธุงูุฑุฉุ
3. **ุงูุฑุจุท ุงูุณุฑูุฑู:** {clinical_question}
4. **ุงูุชูุตูุงุช:** ูุง ุงูุฎุทูุงุช ุงูุชุงููุฉ ุงูููุชุฑุญุฉุ

โ๏ธ ุชุฐูุฑ: ูุฐุง ุชุญููู ูุณุงุนุฏ ูููุณ ุชุดุฎูุตุงู ููุงุฆูุงู.
"""
                    }
                ]
            }
        ]
    )

    return response
```

### 7.3 ุชุญููู ุตูุฑ ูุชุนุฏุฏุฉ (ููุงุฑูุฉ)

```python
def compare_visual_fields(image1_data, image2_data, context):
    """ููุงุฑูุฉ ูุญุตูู ุจุตุฑููู (ูุซู Visual Field ูุจู ูุจุนุฏ)"""

    response = client.messages.create(
        model="claude-sonnet-4-6",
        max_tokens=8192,
        system=SYSTEM_PROMPT,
        messages=[
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": "ุงููุญุต ุงูุฃูู (ูุจู ุงูุชุฃููู):"},
                    {
                        "type": "image",
                        "source": {"type": "base64", "media_type": "image/png", "data": image1_data}
                    },
                    {"type": "text", "text": "ุงููุญุต ุงูุซุงูู (ุจุนุฏ ุงูุชุฃููู):"},
                    {
                        "type": "image",
                        "source": {"type": "base64", "media_type": "image/png", "data": image2_data}
                    },
                    {
                        "type": "text",
                        "text": f"""
ูุงุฑู ุจูู ุงููุญุตูู ุงูุจุตุฑููู:
- ูุง ุงูุชุบููุฑุงุช ุงูููุญูุธุฉุ
- ูู ููุงู ุชุญุณู/ุชุฑุงุฌุน ูู ุงููุฌุงู ุงูุจุตุฑูุ
- ูุง ุงูุฏูุงูุฉ ุงูุณุฑูุฑูุฉุ
ุงูุณูุงู: {context}
"""
                    }
                ]
            }
        ]
    )
    return response
```

### 7.4 ุฃูุถู ุงูููุงุฑุณุงุช ููุตูุฑ ุงูุทุจูุฉ

1. **ุงูุฏูุฉ:** ุชุฃูุฏ ุฃู ุงูุตูุฑุฉ ูุงุถุญุฉ (1568px max ุนูู ุงูุฌุงูุจ ุงูุฃุทูู)
1. **ุงูุณูุงู:** ุฃุถู ุฏุงุฆูุงู ุงูุณุคุงู ุงูุณุฑูุฑู ูุน ุงูุตูุฑุฉ
1. **ุงูุชูุณูู:** JPEG ุฃู PNG (ุชุฌูุจ ุงูุถุบุท ุงูุดุฏูุฏ)
1. **ุงูุชุนุฏุฏ:** ูููู ุฅุฑุณุงู ุญุชู 100 ุตูุฑุฉ ุนุจุฑ API
1. **ุงูุชุฑุชูุจ:** ุถุน ุงูุตูุฑ **ูุจู** ุงููุต ูุฃุฏุงุก ุฃูุถู

-----

## 8. RAG โ ุจูุงุก ุงููุงุนุฏุฉ ุงููุนุฑููุฉ

### 8.1 ููุงุฐุง RAG ููุชุฃููู ุงูุจุตุฑูุ

RAG (Retrieval-Augmented Generation) ูุณูุญ ูู Claude ุจุงููุตูู ููุนุฑูุฉ ูุชุฎุตุตุฉ ุบูุฑ ููุฌูุฏุฉ ูู ุชุฏุฑูุจู ุงูุฃุตููุ ููุง ููููู **ุงููููุณุฉ** (Hallucination) ููุฒูุฏ **ุงูุฏูุฉ**.

### 8.2 ูุตุงุฏุฑ ุงููุงุนุฏุฉ ุงููุนุฑููุฉ

```
๐ ุงููุงุนุฏุฉ ุงููุนุฑููุฉ
โโโ ๐ ุฅุฑุดุงุฏุงุช ุณุฑูุฑูุฉ (Clinical Guidelines)
โ   โโโ WHO - ICD-11 Visual Impairment Classification
โ   โโโ AAO - Preferred Practice Patterns
โ   โโโ RNIB - Low Vision Guidelines
โ   โโโ ACE - Vision Rehabilitation Guidelines
โ   โโโ ICO - Guidelines for Low Vision
โ
โโโ ๐ ูุชุจ ูุฑุฌุนูุฉ (Textbook Chapters)
โ   โโโ Colenbrander - Aspects of Vision Loss
โ   โโโ Massof - Low Vision Enhancement System
โ   โโโ Fletcher - Low Vision Rehabilitation
โ   โโโ Warren - Brain Injury Visual Assessment
โ
โโโ ๐ ุจุฑูุชููููุงุช ุงูุชูููู
โ   โโโ Functional Vision Assessment Protocol
โ   โโโ Learning Media Assessment
โ   โโโ MNREAD Acuity Charts Manual
โ   โโโ Pepper Visual Skills for Reading Test
โ
โโโ ๐ง ุฃุฏูุฉ ุงูุฃุฌูุฒุฉ ุงููุณุงุนุฏุฉ
โ   โโโ Optical Devices Catalog (spectacles, telescopes, magnifiers)
โ   โโโ Electronic Magnification Devices
โ   โโโ Screen Readers & Accessibility Software
โ   โโโ Adaptive Technology Guide
โ
โโโ ๐ ุฎุทุท ุนูุงุฌูุฉ ูููุฐุฌูุฉ
โ   โโโ Age-Related Macular Degeneration Rehab Plan
โ   โโโ Diabetic Retinopathy Rehab Protocol
โ   โโโ Glaucoma Visual Rehabilitation
โ   โโโ Stroke/TBI Visual Rehab Protocol
โ   โโโ Pediatric Low Vision Intervention
โ
โโโ ๐ ููุงุฐุฌ ูููุงูุจ
    โโโ SOAP Note Templates
    โโโ ICF-based Assessment Forms
    โโโ Referral Letter Templates
    โโโ Progress Report Templates
```

### 8.3 ุฎุทูุงุช ุจูุงุก ูุธุงู RAG

#### ุงูุฎุทูุฉ 1: ุงูุชุฌููุฒ ูุงูุชูุทูุน (Chunking)

```python
from langchain.text_splitter import RecursiveCharacterTextSplitter

def prepare_documents(docs_directory: str):
    """ุชุฌููุฒ ุงููุณุชูุฏุงุช ููููุฑุณุฉ"""

    splitter = RecursiveCharacterTextSplitter(
        chunk_size=512,           # ุญุฌู ุงููุทุนุฉ ุจุงูุฑููุฒ
        chunk_overlap=50,         # ุชุฏุงุฎู ูุญูุธ ุงูุณูุงู
        separators=["\n\n", "\n", ". ", " "]
    )

    chunks = []
    for doc in load_documents(docs_directory):
        doc_chunks = splitter.split_text(doc.content)
        for i, chunk in enumerate(doc_chunks):
            chunks.append({
                "text": chunk,
                "metadata": {
                    "source": doc.filename,
                    "category": doc.category,
                    "chunk_index": i,
                    "total_chunks": len(doc_chunks)
                }
            })

    return chunks
```

#### ุงูุฎุทูุฉ 2: Contextual Embeddings (ุชูููุฉ Anthropic)

```python
def add_contextual_prefix(chunk: dict, full_document: str) -> str:
    """ุฅุถุงูุฉ ุณูุงู ููู ูุทุนุฉ โ ุชูููุฉ Contextual Retrieval ูู Anthropic
    ุชููู ูุดู ุงูุงุณุชุฑุฌุงุน ุจูุณุจุฉ 49%"""

    # ุงุณุชุฎุฏู Claude ูุฅูุดุงุก ุณูุงู ูุฎุชุตุฑ
    response = client.messages.create(
        model="claude-sonnet-4-6",
        max_tokens=200,
        messages=[{
            "role": "user",
            "content": f"""
<document>
{full_document[:20000]}
</document>

ูุฐู ูุทุนุฉ ูู ุงููุณุชูุฏ ุฃุนูุงู:
<chunk>
{chunk['text']}
</chunk>

ุงูุชุจ ุฌููุฉ ุฃู ุฌููุชูู ูุฎุชุตุฑุชูู ุชุถุน ูุฐู ุงููุทุนุฉ ูู ุณูุงููุง ุถูู ุงููุณุชูุฏ ุงููุงูู.
ุงุฐูุฑ: ูู ุฃู ูุณู ููุ ูุง ุงูููุถูุน ุงูุฑุฆูุณูุ ููุง ุงููุตุทูุญุงุช ุงููููุฉ.
"""
        }]
    )

    context = response.content[0].text
    return f"{context}\n\n{chunk['text']}"
```

#### ุงูุฎุทูุฉ 3: ุงูููุฑุณุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช ูุชุฌูุฉ (Vector DB)

```python
# ูุซุงู ูุน Pinecone
import pinecone
from sentence_transformers import SentenceTransformer

# ูููุฐุฌ Embedding (ูููุถู ูููุฐุฌ ุทุจู)
embedder = SentenceTransformer("pritamdeka/S-PubMedBert-MS-MARCO")

# ุฃู ููุนุฑุจูุฉ + ุงูุฅูุฌููุฒูุฉ:
# embedder = SentenceTransformer("sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2")

# ุฅูุดุงุก Index
pc = pinecone.Pinecone(api_key="your-pinecone-key")
index = pc.Index("rehab-knowledge-base")

def index_chunks(chunks: list):
    """ููุฑุณุฉ ุงููุทุน ูู Pinecone"""

    batch_size = 100
    for i in range(0, len(chunks), batch_size):
        batch = chunks[i:i+batch_size]

        # ุญุณุงุจ Embeddings
        texts = [c["contextualized_text"] for c in batch]
        embeddings = embedder.encode(texts).tolist()

        # ุชุฌููุฒ ุงูุณุฌูุงุช
        records = [
            {
                "id": f"chunk-{i+j}",
                "values": embeddings[j],
                "metadata": {
                    **batch[j]["metadata"],
                    "text": batch[j]["contextualized_text"]
                }
            }
            for j in range(len(batch))
        ]

        # ุงูุฅุฏุฎุงู
        index.upsert(vectors=records)


def search_vector_db(params: dict) -> dict:
    """ุงูุจุญุซ ูู ุงููุงุนุฏุฉ ุงููุนุฑููุฉ"""

    query = params["query"]
    top_k = params.get("top_k", 5)
    category = params.get("category")

    # ุญุณุงุจ embedding ููุงุณุชุนูุงู
    query_embedding = embedder.encode(query).tolist()

    # ุงูุจุญุซ ูุน ููุชุฑ ุงุฎุชูุงุฑู
    filter_dict = {}
    if category:
        filter_dict["category"] = {"$eq": category}

    results = index.query(
        vector=query_embedding,
        top_k=top_k,
        include_metadata=True,
        filter=filter_dict if filter_dict else None
    )

    return {
        "results": [
            {
                "text": match.metadata.get("text", ""),
                "source": match.metadata.get("source", ""),
                "category": match.metadata.get("category", ""),
                "relevance_score": match.score
            }
            for match in results.matches
        ]
    }
```

#### ุงูุฎุทูุฉ 4: Hybrid Search (BM25 + Semantic)

```python
from rank_bm25 import BM25Okapi

class HybridSearch:
    """ุจุญุซ ูุฌูู ูุฌูุน ุจูู BM25 (ุงููููุงุช ุงูููุชุงุญูุฉ) ู Semantic Search"""

    def __init__(self, chunks, embedder, vector_index):
        self.chunks = chunks
        self.embedder = embedder
        self.index = vector_index

        # ุจูุงุก BM25 index
        tokenized = [c["text"].split() for c in chunks]
        self.bm25 = BM25Okapi(tokenized)

    def search(self, query: str, top_k: int = 5) -> list:
        # BM25 results
        bm25_scores = self.bm25.get_scores(query.split())
        bm25_top = sorted(
            enumerate(bm25_scores),
            key=lambda x: x[1],
            reverse=True
        )[:top_k * 2]

        # Semantic results
        query_emb = self.embedder.encode(query).tolist()
        semantic_results = self.index.query(
            vector=query_emb,
            top_k=top_k * 2,
            include_metadata=True
        )

        # Rank Fusion (Reciprocal Rank Fusion)
        combined = {}
        for rank, (idx, score) in enumerate(bm25_top):
            chunk_id = f"chunk-{idx}"
            combined[chunk_id] = combined.get(chunk_id, 0) + 1 / (rank + 60)

        for rank, match in enumerate(semantic_results.matches):
            combined[match.id] = combined.get(match.id, 0) + 1 / (rank + 60)

        # ุชุฑุชูุจ ูุฅุฑุฌุงุน
        sorted_results = sorted(combined.items(), key=lambda x: x[1], reverse=True)
        return sorted_results[:top_k]
```

### 8.4 ุจุฏูู ุจุณูุท: Prompt Caching ุจุฏูู RAG

ุฅุฐุง ูุงูุช ูุงุนุฏุชู ุงููุนุฑููุฉ ุฃูู ูู **200,000 ุฑูุฒ** (~500 ุตูุญุฉ):

```python
# ุชุญููู ุงููุงุนุฏุฉ ุงููุนุฑููุฉ ุจุงููุงูู ูู System Prompt ูุน Cache
response = client.messages.create(
    model="claude-sonnet-4-6",
    max_tokens=8192,
    system=[
        {
            "type": "text",
            "text": SYSTEM_PROMPT
        },
        {
            "type": "text",
            "text": full_knowledge_base_text,  # ุญุชู 200K tokens
            "cache_control": {"type": "ephemeral"}  # ุชุฎุฒูู ูุคูุช
        }
    ],
    messages=[...]
)
# ุงูุชุฎุฒูู ุงููุคูุช ูููู: ุงูุชูููุฉ 90% + ุงูููุช 50%+
```

-----

## 9. Prompt Chaining โ ุณูุงุณู ุงูุนูู ุงูุทุจูุฉ

### 9.1 ููุงุฐุง Prompt Chainingุ

ุงูุญุงูุงุช ุงูุชุฃููููุฉ ุงููุนูุฏุฉ ุชุญุชุงุฌ ุนุฏุฉ ุฎุทูุงุช ูุชุณูุณูุฉ. ุจุฏูุงู ูู ุทูุจ ูู ุดูุก ูู prompt ูุงุญุฏ (ููุง ูุคุฏู ูููุฏุงู ุฎุทูุงุช)ุ ููุณู ุงูุนูู.

### 9.2 ุณูุณูุฉ ุชูููู ุงูุญุงูุฉ ุงููุงููุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโ
โ Chain 1: ุงูุงุณุชูุจุงู   โ โ ุฌูุน ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
โ  (Intake)           โ   (ุงูุชุดุฎูุตุ ุงูุชุงุฑูุฎุ ุงูุดูุงูู)
โโโโโโโโโโโโฌโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโ
โ Chain 2: ุงูุชูููู    โ โ ุชุญููู ุงูุจูุงูุงุช + ุงูุตูุฑ
โ  (Assessment)       โ   (ุญุฏุฉ ุงูุฅุจุตุงุฑุ ุงููุฌุงู ุงูุจุตุฑู)
โโโโโโโโโโโโฌโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโ
โ Chain 3: ุงูุจุญุซ      โ โ ุจุญุซ PubMed + ุงููุงุนุฏุฉ ุงููุนุฑููุฉ
โ  (Evidence Search)  โ   (ุฃุญุฏุซ ุงูุจุฑูุชููููุงุช ูุงูุฃุจุญุงุซ)
โโโโโโโโโโโโฌโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโ
โ Chain 4: ุงูุฎุทุฉ      โ โ ุจูุงุก ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ
โ  (Treatment Plan)   โ   (SMART Goals + ุฌุฏูู ุฒููู)
โโโโโโโโโโโโฌโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโ
โ Chain 5: ุงููุฑุงุฌุนุฉ   โ โ ูุฑุงุฌุนุฉ ุฐุงุชูุฉ ููุฌูุฏุฉ
โ  (Quality Review)   โ   (ุงุชุณุงูุ ุดููููุฉุ ุฃุฏูุฉ)
โโโโโโโโโโโโฌโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโ
โ Chain 6: ุงูุชูุซูู    โ โ ุฅูุดุงุก ุงูุชูุฑูุฑ (ุจุนุฏ ุงูููุงููุฉ)
โ  (Documentation)    โ   (SOAP Note / ICF Report)
โโโโโโโโโโโโโโโโโโโโโโโ
```

### 9.3 ุงูุชูููุฐ

```python
async def full_case_assessment(patient_data: dict, images: list = None):
    """ุณูุณูุฉ ุชูููู ูุงููุฉ ูุญุงูุฉ ุชุฃููู ุจุตุฑู"""

    # โโโ Chain 1: ุงูุงุณุชูุจุงู ูุงูููู โโโ
    intake_response = await chain_call(
        system_addition="ุฃูุช ุงูุขู ูู ูุฑุญูุฉ ุงูุงุณุชูุจุงู. ุงุฌูุน ูุงููู ูู ุงููุนูููุงุช ุงููุชุงุญุฉ.",
        user_message=f"""
<patient_data>
{json.dumps(patient_data, ensure_ascii=False)}
</patient_data>

ุญูู ุจูุงูุงุช ุงููุฑูุถ ูุญุฏุฏ:
1. ุงูุชุดุฎูุต ุงูุฃุณุงุณู ูุงููุตุงุญุจ
2. ุงููุนูููุงุช ุงููุงูุตุฉ ุงูุชู ุชุญุชุงุฌ ุงุณุชููุงู
3. ุชุตููู ุถุนู ุงูุจุตุฑ ุญุณุจ WHO/ICD-11
4. ุงูุฃููููุงุช ุงูุนูุงุฌูุฉ ุงููุจุฏุฆูุฉ

ุฃุฎุฑุฌ ุงููุชูุฌุฉ ูู XML:
<intake_summary>...</intake_summary>
<missing_info>...</missing_info>
<classification>...</classification>
<priorities>...</priorities>
"""
    )

    # โโโ Chain 2: ุชุญููู ุงูุตูุฑ (ุฅู ููุฌุฏุช) โโโ
    if images:
        assessment_response = await chain_call(
            system_addition="ุฃูุช ุงูุขู ูู ูุฑุญูุฉ ุงูุชูููู ุงูุจุตุฑู.",
            user_message=f"""
ุจูุงุกู ุนูู ุงูุชูููู ุงููุจุฏุฆู:
<intake>{intake_response}</intake>

ุญูู ุงูุตูุฑ/ุงููุญูุตุงุช ุงููุฑููุฉ ูุฑุจุทูุง ุจุงูุญุงูุฉ ุงูุณุฑูุฑูุฉ.
""",
            images=images
        )
    else:
        assessment_response = intake_response

    # โโโ Chain 3: ุงูุจุญุซ ุงูุนููู โโโ
    # (ูุฐุง ูุชู ุชููุงุฆูุงู ุนุจุฑ Tool Use โ Claude ุณูุณุชุฏุนู search_pubmed)
    evidence_response = await chain_call(
        system_addition="ุฃูุช ุงูุขู ูู ูุฑุญูุฉ ุงูุจุญุซ ุงูุนููู.",
        user_message=f"""
ุจูุงุกู ุนูู ุงูุชูููู:
<assessment>{assessment_response}</assessment>

ุงุจุญุซ ุนู ุฃุญุฏุซ ุงูุฃุฏูุฉ ุงูุนูููุฉ ุงููุชุนููุฉ ุจู:
1. ุจุฑูุชููููุงุช ุงูุชุฃููู ููุฐู ุงูุญุงูุฉ
2. ูุนุงููุฉ ุงูุชุฏุฎูุงุช ุงูููุชุฑุญุฉ
3. ุฃู ุฅุฑุดุงุฏุงุช ุณุฑูุฑูุฉ ุญุฏูุซุฉ

ุงุณุชุฎุฏู ุฃุฏุงุฉ search_pubmed ูsearch_knowledge_base.
""",
        tools=tools  # ุชูุนูู ุงูุฃุฏูุงุช
    )

    # โโโ Chain 4: ุจูุงุก ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ โโโ
    plan_response = await chain_call(
        system_addition="ุฃูุช ุงูุขู ูู ูุฑุญูุฉ ุจูุงุก ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ.",
        user_message=f"""
ุจูุงุกู ุนูู ูู ูุง ุณุจู:
<intake>{intake_response}</intake>
<assessment>{assessment_response}</assessment>
<evidence>{evidence_response}</evidence>

ุถุน ุฎุทุฉ ุนูุงุฌูุฉ ุดุงููุฉ ุชุชุถูู:

1. **ุงูุฃูุฏุงู (SMART Goals):**
   - ูุตูุฑุฉ ุงููุฏู (1-4 ุฃุณุงุจูุน)
   - ูุชูุณุทุฉ ุงููุฏู (1-3 ุฃุดูุฑ)
   - ุทูููุฉ ุงููุฏู (3-12 ุดูุฑ)

2. **ุงูุชุฏุฎูุงุช:**
   - ุงูุฃุฌูุฒุฉ ุงููุณุงุนุฏุฉ ุงูููุตู ุจูุง (ูุน ุงูููุงุตูุงุช)
   - ุงูุชูุงุฑูู ุงูุจุตุฑูุฉ (ูุน ุงูุชูุงุตูู)
   - ุงูุชุฏุฑูุจ ุนูู ุงูุชูููุงุช ุงูุชููููุฉ
   - ุงูุชุนุฏููุงุช ุงูุจูุฆูุฉ

3. **ุงูุฌุฏูู ุงูุฒููู:** ุนุฏุฏ ุงูุฌูุณุงุชุ ุงูุชูุฑุงุฑุ ุงููุฏุฉ
4. **ูุนุงููุฑ ุงููุฌุงุญ:** ูุคุดุฑุงุช ูุงุจูุฉ ููููุงุณ
5. **ุฎุทุฉ ุงููุชุงุจุนุฉ:** ููุงุนูุฏ ุงูุชูููู ูุฅุนุงุฏุฉ ุงูุชูููู

ุฃุฎุฑุฌ ุงูุฎุทุฉ ูู XML:
<treatment_plan>...</treatment_plan>
"""
    )

    # โโโ Chain 5: ุงููุฑุงุฌุนุฉ ุงูุฐุงุชูุฉ โโโ
    review_response = await chain_call(
        system_addition="ุฃูุช ุงูุขู ูุฑุงุฌุน ุฌูุฏุฉ. ุฑุงุฌุน ุงูุฎุทุฉ ุจุนูู ูุงูุฏุฉ.",
        user_message=f"""
ุฑุงุฌุน ูุฐู ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ:
<plan>{plan_response}</plan>

ุชุญูู ูู:
1. โ ูู ุงูุฃูุฏุงู ูุงูุนูุฉ ููุงุจูุฉ ููููุงุณุ
2. โ ูู ุงูุชุฏุฎูุงุช ูุฏุนููุฉ ุจุฃุฏูุฉ ุนูููุฉุ
3. โ ูู ููุงู ุชูุงูุถุงุช ุฃู ูุฌูุงุชุ
4. โ ูู ุชู ูุฑุงุนุงุฉ ุนูุงูู ุงููุฑูุถ (ุนูุฑุ ูุฏุฑุงุชุ ุชูุถููุงุช)ุ
5. โ ูู ุงูุฌุฏูู ุงูุฒููู ููุทููุ
6. โ ูู ุชู ุฐูุฑ ููุงูุน ุงูุงุณุชุนูุงู ูุงููุฎุงุทุฑุ

ุฅุฐุง ูุฌุฏุช ูุดุงููุ ุงูุชุฑุญ ุงูุชุนุฏููุงุช.
<quality_review>...</quality_review>
"""
    )

    # โโโ Chain 6: ุงูุชูุซูู (ุจุนุฏ ููุงููุฉ ุงููุณุชุฎุฏู) โโโ
    # ูุฐู ุงูุฎุทูุฉ ุชุชุทูุจ ููุงููุฉ ุตุฑูุญุฉ โ ูุง ุชูููุฐ ุชููุงุฆูุงู
    return {
        "intake": intake_response,
        "assessment": assessment_response,
        "evidence": evidence_response,
        "plan": plan_response,
        "review": review_response,
        "documentation_pending_consent": True
    }


async def chain_call(system_addition: str, user_message: str,
                     images: list = None, tools: list = None) -> str:
    """ุงุณุชุฏุนุงุก ุณูุณูุฉ ูุงุญุฏุฉ"""

    content = []
    if images:
        for img in images:
            content.append({
                "type": "image",
                "source": {
                    "type": "base64",
                    "media_type": img["media_type"],
                    "data": img["data"]
                }
            })
    content.append({"type": "text", "text": user_message})

    kwargs = {
        "model": "claude-sonnet-4-6",
        "max_tokens": 8192,
        "system": SYSTEM_PROMPT + f"\n\n<current_phase>\n{system_addition}\n</current_phase>",
        "messages": [{"role": "user", "content": content}],
        "thinking": {"type": "enabled", "budget_tokens": 8000}
    }
    if tools:
        kwargs["tools"] = tools

    # ุชูููุฐ ูุน Tool Loop
    response = await run_with_tool_loop(**kwargs)
    return extract_text(response)
```

### 9.4 ููุท ุงูุชุญูู ุงูุฐุงุชู (Self-Verification)

```python
# Claude ูุฑุงุฌุน ุนููู ุนุจุฑ prompt ูููุตู
verification_prompt = """
ุฃูุช ูุฏูู ุฌูุฏุฉ ุทุจูุฉ. ุฑุงุฌุน ุงูุฅุฌุงุจุฉ ุงูุชุงููุฉ:

<original_question>{question}</original_question>
<generated_answer>{answer}</generated_answer>

ูููู ุงูุฅุฌุงุจุฉ ูู ุญูุซ:
1. ุงูุฏูุฉ ุงูุทุจูุฉ (1-5)
2. ุงูุงูุชูุงู (1-5)
3. ูุถูุญ ุงูุชูุตูุงุช (1-5)
4. ุงูุงุณุชูุงุฏ ููุฃุฏูุฉ (1-5)
5. ุงูุฃูุงู (ูู ููุฌุฏ ุฃู ุดูุก ูุฏ ูุถุฑ ุงููุฑูุถุ)

ุฅุฐุง ูุงู ุงูุชูููู ุฃูู ูู 4 ูู ุฃู ูุนูุงุฑุ ุฃุนุฏ ุตูุงุบุฉ ุงูุฅุฌุงุจุฉ ุงููุญุณูุฉ.

<verification>
  <scores>...</scores>
  <issues>...</issues>
  <improved_answer>... (ุฅุฐุง ูุฒู)</improved_answer>
</verification>
"""
```

-----

## 10. ุงูุชูุซูู ูุงูุชูุฎูุต

### 10.1 ูุงุนุฏุฉ ุงูููุงููุฉ ุงููุณุจูุฉ

**ูุงุนุฏุฉ ุฐูุจูุฉ:** ูุง ูุชู ุชูุซูู ุฃู ุชูุฎูุต ุฃู ูุนูููุงุช ุฅูุง ุจุนุฏ ููุงููุฉ ุตุฑูุญุฉ.

```python
def request_documentation_consent(summary_preview: str) -> str:
    """ุทูุจ ุงูููุงููุฉ ูุจู ุงูุชูุซูู"""
    return f"""
๐ **ุทูุจ ููุงููุฉ ุนูู ุงูุชูุซูู**

ุจูุงุกู ุนูู ูุญุงุฏุซุชูุงุ ูููููู ุฅุนุฏุงุฏ ุงููุซุงุฆู ุงูุชุงููุฉ:

{summary_preview}

ูู ุชูุงูู ุนูู ุฅูุดุงุก ูุฐุง ุงูุชูุซููุ
โ๏ธ ุณูุชุถูู ุงูุชูุฑูุฑ ุงููุนูููุงุช ุงูุชู ุชูุช ููุงูุดุชูุง ููุท.

๐ ููุงุญุธุฉ: ูุง ูุชู ุชุฎุฒูู ุฃู ุจูุงูุงุช ุดุฎุตูุฉ ุจุฏูู ุชุดููุฑ.
"""
```

### 10.2 ุชูุณููุงุช ุงูุชูุซูู

#### SOAP Note

```python
SOAP_TEMPLATE = """
<soap_note>
  <subjective>
    <!-- ุดููู ุงููุฑูุถ ุงูุฑุฆูุณูุฉ ูุชุงุฑูุฎ ุงูุญุงูุฉ -->
    {subjective}
  </subjective>

  <objective>
    <!-- ูุชุงุฆุฌ ุงููุญูุตุงุช ูุงูููุงุณุงุช -->
    ุญุฏุฉ ุงูุฅุจุตุงุฑ: {visual_acuity}
    ุงููุฌุงู ุงูุจุตุฑู: {visual_field}
    ุญุณุงุณูุฉ ุงูุชุจุงูู: {contrast_sensitivity}
    ูุชุงุฆุฌ ุฅุถุงููุฉ: {additional_findings}
  </objective>

  <assessment>
    <!-- ุงูุชุญููู ูุงูุชูุณูุฑ ุงูุณุฑูุฑู -->
    ุงูุชุดุฎูุต ุงูุชุฃูููู: {rehab_diagnosis}
    ุชุตููู WHO: {who_classification}
    ุงูุฃูุฏุงู ุงููุธูููุฉ ุงููุชุฃุซุฑุฉ: {affected_functions}
  </assessment>

  <plan>
    <!-- ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ -->
    ุงูุฃุฌูุฒุฉ ุงููุณุงุนุฏุฉ: {devices}
    ุงูุชูุงุฑูู: {exercises}
    ุงูุชุนุฏููุงุช ุงูุจูุฆูุฉ: {modifications}
    ุงููุชุงุจุนุฉ: {follow_up}
  </plan>
</soap_note>
"""
```

#### ุชูุฑูุฑ ICF Framework

```python
ICF_TEMPLATE = """
<icf_report>
  <body_functions>
    <!-- ุงููุธุงุฆู ุงูุจุตุฑูุฉ ุงููุชุฃุซุฑุฉ (b210-b229) -->
    {body_functions}
  </body_functions>

  <body_structures>
    <!-- ุงูุจูู ุงูุชุดุฑูุญูุฉ ุงููุชุฃุซุฑุฉ (s210-s229) -->
    {body_structures}
  </body_structures>

  <activities_participation>
    <!-- ุงููููุฏ ูู ุงูุฃูุดุทุฉ ูุงููุดุงุฑูุฉ -->
    ุงููุฑุงุกุฉ: {reading}
    ุงูุชููู: {mobility}
    ุงูุนูุงูุฉ ุงูุดุฎุตูุฉ: {self_care}
    ุงูุนูู: {work}
    ุงูุฃูุดุทุฉ ุงูุงุฌุชูุงุนูุฉ: {social}
  </activities_participation>

  <environmental_factors>
    <!-- ุงูุนูุงูู ุงูุจูุฆูุฉ (ููุณูุฑุฉ / ูุนููุฉ) -->
    {environmental_factors}
  </environmental_factors>

  <personal_factors>
    <!-- ุงูุนูุงูู ุงูุดุฎุตูุฉ -->
    {personal_factors}
  </personal_factors>
</icf_report>
"""
```

### 10.3 ุฅูุดุงุก ุงูุชูุงุฑูุฑ ุจุตูุบ ูุฎุชููุฉ

```python
async def generate_report_after_consent(
    case_data: dict,
    report_type: str,
    format: str = "markdown"
):
    """ุฅูุดุงุก ุงูุชูุฑูุฑ ุจุนุฏ ุงูุญุตูู ุนูู ุงูููุงููุฉ"""

    response = await client.messages.create(
        model="claude-sonnet-4-6",
        max_tokens=8192,
        system=SYSTEM_PROMPT + """
ุฃูุช ุงูุขู ูู ูุถุน ุงูุชูุซูู ุงูุทุจู. ุฃูุดุฆ ุชูุฑูุฑุงู ููููุงู
ูุชุจุน ุงููุนุงููุฑ ุงูุทุจูุฉ ุงููุนุชูุฏุฉ. ุงุณุชุฎุฏู ูุบุฉ ุฏูููุฉ ููุฎุชุตุฑุฉ.
""",
        messages=[{
            "role": "user",
            "content": f"""
ุฃูุดุฆ ุชูุฑูุฑ {report_type} ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงูุชุงููุฉ:

<case_data>
{json.dumps(case_data, ensure_ascii=False, indent=2)}
</case_data>

ุงูุชูุณูู ุงููุทููุจ: {format}
ุงููุบุฉ: ุนุฑุจูุฉ ูุน ุงููุตุทูุญุงุช ุงูุทุจูุฉ ุงูุฅูุฌููุฒูุฉ ุจูู ููุณูู
"""
        }]
    )

    return response.content[0].text
```

-----

## 11. ุงูุฃูุงู ูุงูุฎุตูุตูุฉ

### 11.1 ูุจุงุฏุฆ ุฃุณุงุณูุฉ

```python
SECURITY_GUIDELINES = """
1. โ ุชุดููุฑ ุฌููุน ุงูุจูุงูุงุช ุฃุซูุงุก ุงูููู (TLS 1.2+) ูุฃุซูุงุก ุงูุชุฎุฒูู (AES-256)
2. โ ุนุฏู ุชุฎุฒูู ุจูุงูุงุช ุงููุฑูุถ ูู System Prompt ุจุดูู ุฏุงุฆู
3. โ ุงุณุชุฎุฏุงู Zero Data Retention (ZDR) ุนูุฏ ุงูุชููุฑ
4. โ ุทูุจ ุงูููุงููุฉ ูุจู ุฃู ุชูุซูู ุฃู ุชูุฎูุต
5. โ ุฅุถุงูุฉ Disclaimers ูู ูู ุงุณุชุฌุงุจุฉ ุทุจูุฉ
6. โ ุนุฏู ุชูุฏูู ุชุดุฎูุต ููุงุฆู โ ููุท ุชุญููู ูุณุงุนุฏ
7. โ ุชุณุฌูู Audit Logs ููู ุชูุงุนู
8. โ ูุฑุงุฌุนุฉ ุจุดุฑูุฉ ุฅูุฒุงููุฉ ููุชูุตูุงุช ุงูุญุฑุฌุฉ
"""
```

### 11.2 Input Validation

```python
import re

def sanitize_patient_input(text: str) -> str:
    """ุชูุธูู ูุฏุฎูุงุช ุงููุณุชุฎุฏู"""

    # ุฅุฒุงูุฉ ุฃู ูุญุงููุฉ Prompt Injection
    dangerous_patterns = [
        r"ignore\s+previous\s+instructions",
        r"ignore\s+all\s+above",
        r"you\s+are\s+now",
        r"system:\s*",
        r"<\s*system\s*>",
    ]
    for pattern in dangerous_patterns:
        text = re.sub(pattern, "[FILTERED]", text, flags=re.IGNORECASE)

    # ุฅุฒุงูุฉ ุจูุงูุงุช ุญุณุงุณุฉ ุบูุฑ ุถุฑูุฑูุฉ
    # (ุฃุฑูุงู ุงููููุฉุ ุจุทุงูุงุช ุงูุงุฆุชูุงูุ ุฅูุฎ)
    text = re.sub(r'\b\d{10,}\b', '[REDACTED_ID]', text)

    return text


def validate_medical_output(response: str) -> str:
    """ุงูุชุญูู ูู ุฃู ุงูุงุณุชุฌุงุจุฉ ุชุญุชูู ุนูู Disclaimers"""

    disclaimer = "\n\nโ๏ธ **ุชูุจูู:** ูุฐุง ุชุญููู ูุณุงุนุฏ ูููุณ ุจุฏููุงู ุนู ุงูุฑุฃู ุงูุทุจู ุงููุจุงุดุฑ."

    if "ููุณ ุจุฏููุงู" not in response and "ุชูุจูู" not in response:
        response += disclaimer

    return response
```

### 11.3 HIPAA Considerations

```python
# ุฅุนุฏุงุฏุงุช API ููุจูุฆุงุช ุงูุทุจูุฉ
HIPAA_CONFIG = {
    # ุงุณุชุฎุฏุงู Zero Data Retention
    "headers": {
        "anthropic-beta": "zero-data-retention-2025-01-01"
    },

    # ูุง ุชูุฑุณู ุจูุงูุงุช ุชุนุฑูููุฉ
    "metadata_policy": "no_pii_in_metadata",

    # Audit logging
    "audit_logging": True,

    # Session timeout
    "session_timeout_minutes": 30,

    # ุชุดููุฑ ุงูุจูุงูุงุช ุงููุญููุฉ
    "local_encryption": "AES-256-GCM"
}
```

-----

## 12. ุฃูุซูุฉ ุชุทุจูููุฉ ูุงููุฉ

### 12.1 ูุซุงู: ุญุงูุฉ ุถููุฑ ุจูุนู ูุฑุชุจุท ุจุงูุนูุฑ (AMD)

```python
# ุงููุณุชุฎุฏู ูุณุฃู ุนู ุญุงูุฉ ูุฑูุถ
user_query = """
ูุฏู ูุฑูุถุฉ ุนูุฑูุง 72 ุณูุฉ ูุตุงุจุฉ ุจุงูุถููุฑ ุงูุจูุนู ุงูุฌุงู (Dry AMD) ูู ููุชุง ุงูุนูููู.

ุงูุนูู ุงููููู: 6/60 (LogMAR 1.0)
ุงูุนูู ุงููุณุฑู: 6/36 (LogMAR 0.78)
ุงููุฌุงู ุงูุจุตุฑู: ุณููู ูุญูุทูุงู ูุน scotoma ูุฑูุฒู

ุงูุดููู ุงูุฑุฆูุณูุฉ: ุตุนูุจุฉ ุงููุฑุงุกุฉ ูุชูููุฒ ุงููุฌูู
ุชุฑูุฏ ุงูุงุณุชูุฑุงุฑ ูู ูุฑุงุกุฉ ุงููุฑุขู ูุงูุทุจุฎ

ูุง ุฎุทุฉ ุงูุชุฃููู ุงูููุงุณุจุฉุ
"""

# Claude ุณูููู ุชููุงุฆูุงู ุจู:
# 1. ุชูุนูู Extended Thinking ูุชุญููู ุงูุญุงูุฉ
# 2. ุงูุจุญุซ ูู PubMed ุนู ุฃุญุฏุซ ุจุฑูุชููููุงุช AMD rehabilitation
# 3. ุงูุจุญุซ ูู ุงููุงุนุฏุฉ ุงููุนุฑููุฉ ุนู ุฎุทุท ุนูุงุฌูุฉ ูุดุงุจูุฉ
# 4. ุญุณุงุจ ููุฉ ุงูููุจุฑ ุงููุทููุจุฉ ุนุจุฑ visual_calculator
# 5. ุชูุฏูู ุฎุทุฉ ุดุงููุฉ ูุน ุฃุฏูุฉ

response = run_rehab_consultant(user_query)
```

### 12.2 ูุซุงู: ุชุญููู ุตูุฑุฉ OCT

```python
# ุชุญููู ุตูุฑุฉ OCT ูุน ุณูุงู ุณุฑูุฑู
result = analyze_medical_image(
    image_path="patient_oct_scan.png",
    clinical_question="""
ูุฐุง ูุญุต OCT ููุฑูุถ 55 ุณูุฉ ูุตุงุจ ุจุงูุณูุฑู ูู 20 ุณูุฉ.
ูุดุชูู ูู ุถุจุงุจูุฉ ููุงุฌุฆุฉ ูู ุงูุนูู ุงููููู.
ูุง ุชุญูููู ููุฐุง ุงููุญุต ููุง ุงูุชูุตูุงุช ุงูุชุฃููููุฉุ
"""
)
```

### 12.3 ูุซุงู: ุจุญุซ ุนููู ููุฌู

```python
# ุงููุณุชุฎุฏู ูุทูุจ ุจุญุซุงู ุนู ุชูููุฉ ูุนููุฉ
user_query = """
ูุง ุงูุฃุฏูุฉ ุงูุนูููุฉ ุนูู ูุนุงููุฉ ุชุฏุฑูุจ Eccentric Viewing
ูู ุชุญุณูู ุณุฑุนุฉ ุงููุฑุงุกุฉ ููุฑุถู AMDุ
ุฃุฑูุฏ ุฃุจุญุงุซ ูู ุขุฎุฑ 5 ุณููุงุช ููุท.
"""

# Claude ุณูุณุชุฏุนู:
# 1. search_pubmed(query="eccentric viewing training AMD reading speed",
#                  date_range="2020:2026",
#                  article_types=["review", "clinical-trial"])
# 2. fetch_article_details ูุฃูู 3-5 ููุงูุงุช
# 3. ุชูุฎูุต ุงููุชุงุฆุฌ ูุน ูุณุชูู ุงูุฏููู
```

-----

## 13. ุฎุงุฑุทุฉ ุชุทููุฑ ุงููุงุนุฏุฉ ุงููุนุฑููุฉ

### 13.1 ุงููุฑุญูุฉ 1: ุงูุฃุณุงุณ (ุดูุฑ 1-2)

```
โ ุฌูุน ุงูุฅุฑุดุงุฏุงุช ุงูุณุฑูุฑูุฉ ุงูุฃุณุงุณูุฉ (WHO, AAO, ICO)
โ ุฅูุดุงุก ุจุฑูุชููููุงุช ุงูุชูููู ุงูุฃุณุงุณูุฉ
โ ุจูุงุก Vector DB ุจุณูุท ูุน 50-100 ูุณุชูุฏ
โ ุชูููุฐ E-Utilities API ูู PubMed
โ ุงุฎุชุจุงุฑ System Prompt ูุชุญุณููู
```

### 13.2 ุงููุฑุญูุฉ 2: ุงูุชูุณุน (ุดูุฑ 3-4)

```
๐ฒ ุฅุถุงูุฉ Contextual Embeddings (Anthropic technique)
๐ฒ ุชูููุฐ Hybrid Search (BM25 + Semantic)
๐ฒ ุจูุงุก ููุชุจุฉ ุฎุทุท ุนูุงุฌูุฉ ูููุฐุฌูุฉ (20+ ุญุงูุฉ)
๐ฒ ุฏูุฌ PubMed MCP Server
๐ฒ ุฅุถุงูุฉ ุฃุฏูุงุช ุญุณุงุจูุฉ ูุชูุฏูุฉ
๐ฒ ุชูููุฐ Prompt Chaining ุงููุงูู
```

### 13.3 ุงููุฑุญูุฉ 3: ุงูุชุญุณูู (ุดูุฑ 5-6)

```
๐ฒ Knowledge Graph ููุนูุงูุงุช ุจูู ุงูุฃูุฑุงุถ ูุงูุชุฏุฎูุงุช
๐ฒ Reranking ูุชูุฏู (Cross-Encoder)
๐ฒ ุชูููู ุงูุฃุฏุงุก (Evaluation Framework)
๐ฒ Few-shot examples ูู ุญุงูุงุช ุญููููุฉ (ูุฌูููุฉ ุงููููุฉ)
๐ฒ ุงูุชูุซูู ุงูุชููุงุฆู ุจุตูุบ ูุชุนุฏุฏุฉ (PDF, DOCX)
๐ฒ ุฏุนู Multi-turn ูุน ุฐุงูุฑุฉ ุงูุฌูุณุฉ
```

### 13.4 ุงููุฑุญูุฉ 4: ุงูุฅูุชุงุฌ (ุดูุฑ 7+)

```
๐ฒ HIPAA Compliance ุงููุงูู
๐ฒ Audit Logging ุดุงูู
๐ฒ ูุงุฌูุฉ ูุณุชุฎุฏู ูุชุฎุตุตุฉ (Web/Mobile)
๐ฒ ุชูุงูู ูุน ุฃูุธูุฉ EMR/EHR
๐ฒ ูุฑุงุฌุนุฉ ุทุจูุฉ ุฏูุฑูุฉ ูููุงุนุฏุฉ ุงููุนุฑููุฉ
๐ฒ ุชุญุฏูุซ ุชููุงุฆู ูู PubMed (RSS/Alerts)
๐ฒ ูุธุงู ุชูููู ูู ุงููุชุฎุตุตูู (Human-in-the-loop)
```

### 13.5 ุงุณุชุฑุงุชูุฌูุฉ ุชุญุฏูุซ ุงููุงุนุฏุฉ ุงููุนุฑููุฉ

```python
# ูุธุงู ุชุญุฏูุซ ุฏูุฑู
UPDATE_STRATEGY = {
    "pubmed_alerts": {
        "frequency": "weekly",
        "queries": [
            "low vision rehabilitation[MeSH] AND last 7 days[dp]",
            "vision rehabilitation AND clinical trial[pt] AND last 30 days[dp]",
            "assistive technology visual impairment AND review[pt]"
        ],
        "auto_index": True  # ููุฑุณุฉ ุชููุงุฆูุฉ ูู Vector DB
    },

    "guideline_updates": {
        "frequency": "quarterly",
        "sources": ["WHO", "AAO", "RNIB", "ACE"],
        "manual_review": True  # ูุฑุงุฌุนุฉ ุจุดุฑูุฉ ูุจู ุงูุฅุถุงูุฉ
    },

    "quality_audit": {
        "frequency": "monthly",
        "metrics": [
            "retrieval_precision",
            "answer_accuracy",
            "user_satisfaction",
            "citation_validity"
        ]
    }
}
```

-----

## 14. ุงููุฑุงุฌุน ูุงููุตุงุฏุฑ

### ุงูุชูุซูู ุงูุฑุณูู

- [Claude API - Messages API](https://platform.claude.com/docs/en/api/messages)
- [Claude API - Tool Use](https://platform.claude.com/docs/en/agents-and-tools/tool-use/overview)
- [Claude API - Vision](https://platform.claude.com/docs/en/build-with-claude/vision)
- [Claude API - Extended Thinking](https://platform.claude.com/docs/en/build-with-claude/extended-thinking)
- [Claude API - Adaptive Thinking](https://platform.claude.com/docs/en/build-with-claude/adaptive-thinking)
- [Claude API - Prompt Chaining](https://platform.claude.com/docs/en/build-with-claude/prompt-engineering/chain-prompts)
- [Claude API - System Prompts](https://platform.claude.com/docs/en/build-with-claude/prompt-engineering/system-prompts)
- [Contextual Retrieval (Anthropic)](https://www.anthropic.com/news/contextual-retrieval)
- [Think Tool (Anthropic)](https://www.anthropic.com/engineering/claude-think-tool)
- [Advanced Tool Use (Anthropic)](https://www.anthropic.com/engineering/advanced-tool-use)

### PubMed & NCBI

- [NCBI E-Utilities Overview](https://www.ncbi.nlm.nih.gov/books/NBK25497/)
- [E-Utilities Quick Start](https://www.ncbi.nlm.nih.gov/books/NBK25500/)
- [PubMed MCP Server](https://playbooks.com/mcp/jackkuo666-pubmed)
- [PubMed Connector in Claude](https://support.claude.com/en/articles/12614801)

### RAG & Knowledge Bases

- [RAG for Healthcare (Springer, 2025)](https://link.springer.com/article/10.1007/s00521-025-11666-9)
- [MedRAG: KG-Enhanced RAG (ACM, 2025)](https://dl.acm.org/doi/10.1145/3696410.3714782)
- [RAG for Medical Fitness (npj Digital Medicine, 2025)](https://www.nature.com/articles/s41746-025-01519-z)

### ุฃุฏูุงุช ููุฑูู ููุฑูุงุช

- [LangChain](https://python.langchain.com/)
- [Pinecone Vector DB](https://www.pinecone.io/)
- [ChromaDB](https://www.trychroma.com/)
- [Sentence Transformers](https://www.sbert.net/)
- [PubMedBERT Embeddings](https://huggingface.co/pritamdeka/S-PubMedBert-MS-MARCO)

### ุงูุชุฃููู ุงูุจุตุฑู (ูุฑุงุฌุน ููููุฉ)

- WHO ICD-11: Visual Impairment Classification
- American Academy of Ophthalmology (AAO) Preferred Practice Patterns
- International Council of Ophthalmology (ICO) Low Vision Guidelines
- Royal National Institute of Blind People (RNIB) Standards
- Association for Education and Rehabilitation (AER) Standards

-----

## โก ููุฎุต ุณุฑูุน: ุฎุทูุงุช ุงูุจุฏุก

```bash
# 1. ุชุซุจูุช ุงููุชุทูุจุงุช
pip install anthropic requests pinecone sentence-transformers rank-bm25

# 2. ุชุนููู API Keys
export ANTHROPIC_API_KEY="sk-ant-..."
export NCBI_API_KEY="your-ncbi-key"
export PINECONE_API_KEY="your-pinecone-key"

# 3. ุชุฌููุฒ ุงููุงุนุฏุฉ ุงููุนุฑููุฉ
python prepare_knowledge_base.py --input ./docs --output ./embeddings

# 4. ุชุดุบูู ุงููุธุงู
python rehab_consultant.py
```

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                      โ
โ  ๐ฏ ุงููุฏู ุงูููุงุฆู:                                   โ
โ                                                      โ
โ  ูุธุงู ูุฌูุน ุจูู:                                     โ
โ  โ ุฎุจุฑุฉ ุณุฑูุฑูุฉ ุนูููุฉ (System Prompt)                โ
โ  โ ุชูููุฑ ููุทูู ูุชูุฏู (Extended Thinking)            โ
โ  โ ูุตูู ูุฃุญุฏุซ ุงูุฃุจุญุงุซ (PubMed + RAG)               โ
โ  โ ุชุญููู ุจุตุฑู (Vision)                              โ
โ  โ ุฃุฏูุงุช ูุชุฎุตุตุฉ (Tool Use)                          โ
โ  โ ุณูุงุณู ุนูู ููุธูุฉ (Prompt Chaining)                โ
โ  โ ุชูุซูู ูููู (ุจุนุฏ ุงูููุงููุฉ)                        โ
โ  โ ุฃูุงู ูุฎุตูุตูุฉ (HIPAA-ready)                       โ
โ                                                      โ
โ  ๐ก ููููู ุฃูุถู ูุณุงุนุฏ ุชุฃูููู ูููู                    โ
โ     ูุน ุงูุญูุงุธ ุนูู ุฃู ุงููุฑุงุฑ ุงูููุงุฆู ูููุชุฎุตุต ุงูุจุดุฑู  โ
โ                                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

-----

> **ุขุฎุฑ ุชุญุฏูุซ:** ูุจุฑุงูุฑ 2026
> **ุงูุฅุตุฏุงุฑ:** 1.0
> **ุงููุคูู:** ูุธุงู ููุนุฏ ุนุจุฑ Claude Opus 4.6
> **ุงูุชุฑุฎูุต:** ููุงุณุชุฎุฏุงู ุงูุชุนูููู ูุงููููู โ ููุณ ููุชุดุฎูุต ุงูุทุจู ุงููุจุงุดุฑ
